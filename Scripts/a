for p in doc.paragraphs:
    # Unir todos los runs en texto completo
    texto_original = "".join(run.text for run in p.runs)
    texto_modificado = texto_original

    # Aplicar los reemplazos globales
    for clave, nuevo in reemplazos.items():
        if clave in texto_modificado:
            texto_modificado = texto_modificado.replace(clave, nuevo)

    # Si cambió, borramos y reconstruimos el párrafo
    if texto_modificado != texto_original:
        # Tomar las propiedades del primer run como base
        estilo_base = p.runs[0].style if p.runs else None
        fuente_base = p.runs[0].font if p.runs else None

        # Limpiar todos los runs existentes
        for run in p.runs:
            run.clear()

        # Agregar el nuevo texto como un solo run
        nuevo_run = p.add_run(texto_modificado)

        # Restaurar estilo si existía
        if estilo_base:
            nuevo_run.style = estilo_base
        if fuente_base:
            nuevo_run.font.name = fuente_base.name
            nuevo_run.font.size = fuente_base.size
            nuevo_run.font.bold = fuente_base.bold
            nuevo_run.font.italic = fuente_base.italic